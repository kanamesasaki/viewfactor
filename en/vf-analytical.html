<!doctype html>
<html lang="en">
<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-CCZTCJYRD8"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-CCZTCJYRD8');
  </script>
  <meta charset="UTF-8">
  <title>View Factor Calculator</title>
  <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link rel="stylesheet" href="../style.css">
</head>

<header>
  <a href="index.html">View Factor Calculator</a> &#187;<a href="vf-analytical.html">How to calculate a view factor analytically.</a>
  <span style="float: right"><ul class="select-lang">
      <li><a href="../en/index.html">English</a></li>
      <li><a href="">Deutsch</a></li>
      <li><a href="">日本語</a></li>
  </ul></span>
</header>
<body>
  <h1>How to calculate a view factor analytically.</h1>
  <h2>微小表面から円板へのView Factor</h2>
  <p>
    今回は，微小表面から円板へのView Factor例に，View Factorの具体的な計算方法を説明する．
    微小表面と円板の形状，および位置関係は以下の図のように，\((R,~h,~\omega)\)によって表されるものとする．
  </p>
  <img src="..\images\disk.svg" width="300">

  <h2>面積分によるView Factorの計算</h2>
  <p>定義どおり真面目に積分してやればView Factorを計算することが出来る．</p>

  \begin{align}
  F &= \int_A \frac{\cos \Omega \cos \Lambda}{\pi S^2} dA
  = \int_0^R \int_0^{2\pi} \frac{\cos \Omega \cos \Lambda}{\pi (r^2+h^2)}\ r d \beta dr \notag \\
  &= \int_0^R \int_0^{2\pi} \frac{r^2h \sin \omega \cos \beta + rh^2 \cos \omega}{\pi (r^2+h^2)^2} d\beta dr
  = \int_0^R \frac{2 rh^2 \cos \omega}{(r^2+h^2)^2} dr \notag \\
  &= \left[- \frac{h^2 \cos \omega}{r^2 + h^2} \right]^R_0
  = \frac{R^2}{R^2 + h^2} \cos \omega = \frac{1}{1 + (\frac{h}{R})^2} \cos \omega \tag{1}
  \end{align}

  <p>ただし，\(\cos \Omega\)と\(\cos \Lambda\)の変形は次のように行っている．</p>

  \begin{gather}
  \cos \Omega = \frac{\boldsymbol{\omega} \cdot \boldsymbol{r}}{\|\boldsymbol{\omega}\| \|\boldsymbol{r}\|} 
  = \frac{r \sin \omega \cos \beta + h \cos \omega}{\sqrt{r^2 + h^2}} \tag{2} \\
  \mathrm{where}~~\boldsymbol{\omega} = \left( \begin{array}{c} \sin\omega \\ 0 \\ \cos \omega \end{array} \right), \hspace{10pt}
  \boldsymbol{r} = \left( \begin{array}{c} r \cos \alpha \\ r \sin \alpha \\ h \end{array} \right) \notag
  \end{gather}

  \begin{equation}
  h \tan \Lambda = r, \hspace{10pt}
  \cos \Lambda = \frac{h}{\sqrt{r^2 + h^2}} \tag{3}
  \end{equation}

  <p>
    ここまでに計算したのは，円板全体が見えている場合だ．もし微小表面の方向がもう少し倒れてくる（\(\omega\)が大きくなる）と，
    円板の一部が視野の水平線の下に落ち込んで見えなくなる．
    このような場合，円板の見えている部分のみについて面積分しないといけないので，計算が一気に煩雑になる．
  </p>
  <img src="..\images\disk_area.svg" width="300">
  <p>積分を実行するために，積分領域を2つに分割する．1つ目は円弧状の領域（\(0 \le \beta \le \beta_0\)）．2つ目は三角形状の領域である．</p>

  \begin{align}
  F &= \int_A \frac{\cos \Omega \cos \Lambda}{\pi S^2} dA
  = \int_0^R \int_{0}^{\beta_0} \frac{2 \cos \Omega \cos \Lambda}{\pi (r^2+h^2)} r d \beta dr + \int^0_{R \cos \beta_0} \int_0^{x \tan \beta_0} \frac{2 \cos \Omega \cos \Lambda}{\pi (x^2 + y^2 + h^2)} dy dx \\
  &= \int^R_0 \int_{0}^{\beta_0} \frac{2r^2h \sin \omega \cos \beta + 2rh^2 \cos \omega}{\pi (r^2 + h^2)^2} d\beta dr + \int^0_{R \cos \beta_0} \int_0^{x \tan \beta_0} \frac{2xh \sin \omega + 2h^2 \cos \omega}{\pi (x^2 + y^2 + h^2)^2} dy dx \\
  &= \int^R_0 \frac{2r^2h \sin \omega \sin \beta_0}{\pi (r^2 + h^2)^2}dr + \int^R_0 \frac{2\beta_0 rh^2 \cos \omega}{\pi (r^2 + h^2)^2}dr + \int_0^{R \sin \beta_0} \int^{\frac{y}{\tan \beta_0}}_{R \cos \beta_0} \frac{2xh \sin \omega}{\pi (x^2 + y^2 + h^2)^2} dx dy
  + \int^0_{R \cos \beta_0} \int_0^{x \tan \beta_0} \frac{2h^2 \cos \omega}{\pi (x^2 + y^2 + h^2)^2} dy dx \tag{4}
  \end{align}

  <p>三角形部分での，\(\cos \Omega\)と\(\cos \Lambda\)の変形には次の関係を用いた．</p>

  \begin{gather}
  \cos \Omega = \frac{\boldsymbol{\omega} \cdot \boldsymbol{r}}{\|\boldsymbol{\omega}\| \|\boldsymbol{r}\|} = \frac{x \sin \omega + h \cos \omega}{\sqrt{x^2 + y^2 + h^2}} \tag{5} \\
  \mathrm{where}~~\boldsymbol{\omega} = \left( \begin{array}{c} \sin\omega \\ 0 \\ \cos \omega \end{array} \right) \hspace{5pt}
  \boldsymbol{r} = \left( \begin{array}{c} x \\ y \\ h \end{array} \right)
  \end{gather}

  \begin{gather}
  h \tan \Lambda = \sqrt{x^2 + y^2}, \hspace{10pt}
  \cos \Lambda = \frac{h}{\sqrt{x^2 + y^2 + h^2}} \tag{6}
  \end{gather}

  <p>ここから順番に各項の積分を求めていく．</p>
  <p>1項目：</p>

  \begin{align}
  &\int^R_0 \frac{2r^2h \sin \omega \sin \beta_0}{\pi (r^2 + h^2)^2}dr
  = \frac{2 \sin \omega \sin \alpha_0}{\pi} \int_0^{\frac{R}{h}} \frac{u^2}{(u^2 + 1)^2} du \hspace{10pt} \mathrm{where}\ u=\frac{r}{h}\\
  &= \frac{2 \sin \omega \sin \beta_0}{\pi} \int_0^{\arctan \frac{R}{h}} \frac{\tan^2 t}{(\tan^2 t + 1)^2} \frac{dt}{\cos^2 t} \hspace{10pt} \mathrm{where}\ \tan t=u \\
  &= \frac{2 \sin \omega \sin \beta_0}{\pi} \int_0^{\arctan \frac{R}{h}} \sin^2 t dt
  = \frac{\sin \omega \sin \beta_0}{\pi} \int_0^{\arctan \frac{R}{h}} 1 - \cos 2t dt \\
  &= \frac{\sin \omega \sin \beta_0}{\pi} \left[t - \frac{1}{2} \sin 2t \right]^{\arctan \frac{R}{h}}_0
  = \frac{\sin \omega \sin \beta_0}{\pi} \left[t - \frac{\tan t}{1+ \tan^2 t} \right]^{\arctan \frac{R}{h}}_0 \\
  &= \frac{\sin \omega \sin \beta_0}{\pi} \left( \arctan \frac{R}{h} - \frac{Rh}{R^2 + h^2} \right) \tag{7}
  \end{align}

  <p>2項目：</p>

  \begin{gather}
  \int^R_0 \frac{2\beta_0 rh^2 \cos \omega}{\pi (r^2 + h^2)^2}dr
  = \left[ - \frac{\beta_0 h^2 \cos \omega}{\pi (r^2 + h^2)} \right]^R_0
  = \frac{\beta_0 \cos \omega}{\pi} \frac{R^2}{R^2 + h^2}
  = \frac{\beta_0 \cos \omega}{\pi} \frac{1}{1 + (h/R)^2} \tag{8}
  \end{gather}

  <p>3項目：</p>

  \begin{align}
  &\int_0^{R \sin \beta_0} \int^{\frac{y}{\tan \alpha_0}}_{R \cos \alpha_0} \frac{2xh \sin \omega}{\pi (x^2 + y^2 + h^2)^2} dx dy
  = \int_0^{R \sin \beta_0} \left[ - \frac{h \sin \omega}{\pi (x^2 + y^2 + h^2)} \right]^{\frac{y}{\tan \beta_0}}_{R \cos \beta_0} dy \\
  &= \frac{h \sin \omega}{\pi}\int_0^{R \sin \alpha_0} \left( \frac{1}{y^2 + h^2 + R^2 \cos^2 \beta_0} - \frac{1}{\frac{y^2}{\sin^2 \beta_0} + h^2} \right) dy \\
  &= \frac{h \sin \omega}{\pi}\int_0^{R \sin \beta_0} \frac{1}{\frac{y^2}{h^2 + R^2 \cos^2 \beta_0} + 1} \frac{dy}{h^2 + R^2 \cos^2 \beta_0} - \frac{h \sin \omega}{\pi} \int_0^{R \sin \beta_0} \frac{1}{\frac{y^2}{h^2 \sin^2 \beta_0} + 1} \frac{dy}{h^2} \\
  &= \frac{h \sin \omega}{\pi} \int_0^{\arctan \frac{R\sin \beta_0}{\sqrt{h^2 + R^2 \cos^2 \beta_0}}} \frac{du}{\sqrt{h^2 + R^2 \cos^2 \alpha_0}} - \frac{h \sin \omega}{\pi} \int_0^{\arctan \frac{R}{h}} \frac{\sin \beta_0}{h} dv \\
  &= \frac{h \sin \omega}{\pi \sqrt{h^2 + R^2 \cos^2 \beta_0}} \arctan \frac{R\sin \beta_0}{\sqrt{h^2 + R^2 \cos^2 \beta_0}} - \frac{\sin \omega \sin \beta_0}{\pi} \arctan \frac{R}{h} \tag{9}
  \end{align}

  <p>4項目：</p>
  <p>まずY方向に積分する．</p>
  \begin{align}
  &\int_0^{x \tan \alpha_0} \frac{1}{(y^2 + x^2 + h^2)^2} dy
  = \int_0^{x \tan \alpha_0} \frac{\frac{1}{(x^2 + h^2)^2}}{(\frac{y^2}{x^2 + h^2} + 1)^2} dy
  = \frac{\sqrt{x^2 + h^2}}{(x^2 + h^2)^2} \int_0^{\frac{x \tan \alpha_0}{\sqrt{x^2 + h^2}}} \frac{1}{(u^2 + 1)^2} du \\
  &= \frac{\sqrt{x^2 + h^2}}{(x^2 + h^2)^2} \int_0^{\arctan(\frac{x \tan \alpha_0}{\sqrt{x^2 + h^2}})} \frac{1}{(\tan^2 t + 1)^2} \frac{1}{\cos^2 t}dt \\&= \frac{\sqrt{x^2 + h^2}}{(x^2 + h^2)^2} \int_0^{\arctan(\frac{x \tan \alpha_0}{\sqrt{x^2 + h^2}})} \cos^2 t dt
  = \frac{\sqrt{x^2 + h^2}}{2(x^2 + h^2)^2} \int_0^{\arctan(\frac{x \tan \alpha_0}{\sqrt{x^2 + h^2}})} \cos 2t + 1 dt \\&= \frac{\sqrt{x^2 + h^2}}{2(x^2 + h^2)^2} \left[ \frac{1}{2}\sin 2t + t\right]_0^{\arctan(\frac{x \tan \alpha_0}{\sqrt{x^2 + h^2}})}
  = \frac{\sqrt{x^2 + h^2}}{2(x^2 + h^2)^2} \left[ \frac{\tan t}{\tan^2 t + 1} + t\right]_0^{\arctan(\frac{x \tan \alpha_0}{\sqrt{x^2 + h^2}})} \\&= \frac{\sqrt{x^2 + h^2}}{2(x^2 + h^2)^2} \left\{ \frac{\frac{x \tan \alpha_0}{\sqrt{x^2 + h^2}}}{\frac{x^2 \tan^2 \alpha_0}{x^2 + h^2} + 1} + \arctan \left(\frac{x \tan \alpha_0}{\sqrt{x^2 + h^2}}\right)\right\} \\
  &= \frac{1}{2} (x^2 + h^2)^{-1} \frac{x \tan \alpha_0}{x^2 (\tan^2 \alpha_0 + 1) + h^2} + \frac{1}{2} (x^2 + h^2)^{-\frac{3}{2}} \arctan \frac{x \tan \alpha_0}{\sqrt{x^2 + h^2}} \tag{10}
  \end{align}

  <p>置換積分は以下のように行った．</p>

  \begin{gather}
  \frac{x \tan \alpha_0}{\sqrt{x^2 + h^2}} = \tan u \tag{11}\\
  h^2 \tan \alpha_0 (x^2 + h^2)^{-\frac{3}{2}} dx = \frac{du}{\cos^2 u} \tag{12}
  \end{gather}

  <p>積分結果を今度はX方向に積分する．</p>

  \begin{align}
  &\int^0_{R \cos \beta_0} \frac{1}{2} (x^2 + h^2)^{-\frac{3}{2}} \arctan \frac{x \tan \alpha_0}{\sqrt{x^2 + h^2}} dx \\
  &= \int^0_{\arctan \left( \frac{R \sin \beta_0}{\sqrt{R^2 \cos^2 \alpha_0 + h^2}} \right)} \frac{u du}{2 h^2 \tan \beta_0 \cos^2 u}
  = \frac{1}{2h^2 \tan \beta_0}\left[ u \tan u + \log (\cos u) \right]^0_{\arctan \left( \frac{R \sin \beta_0}{\sqrt{R^2 \cos^2 \beta_0 + h^2}} \right)} \\
  &= -\frac{1}{2h^2 \tan \beta_0} \left[ \frac{R \sin \beta_0}{\sqrt{R^2 \cos^2 \beta_0 + h^2}} \arctan \left( \frac{R \sin \beta_0}{\sqrt{R^2 \cos^2 \beta_0 + h^2}} \right)
  \log \left\{ \cos \left( \arctan \left( \frac{R \sin \beta_0}{\sqrt{R^2 \cos^2 \beta_0 + h^2}} \right) \right) \right\} \right] \tag{13}
  \end{align}

  \begin{align*}
  &\int^0_{R \cos \beta_0} \frac{1}{2} (x^2 + h^2)^{-1} \frac{x \tan \beta_0}{x^2 (\tan^2 \beta_0 + 1) + h^2} dx \\
  &= \int^0_{R \cos \beta_0} \frac{1}{4 h^2 \tan \beta_0} \left\{ \frac{2x(\tan^2 \beta_0 + 1)}{(\tan^2 \beta_0 + 1) x^2 + h^2} - \frac{2x}{x^2 + h^2} \right\} dx \\
  &= \frac{1}{4 h^2 \tan \beta_0} \left[ \log \left( 1 + \frac{x^2 \tan^2 \beta_0}{x^2 + h^2} \right) \right]^0_{R \cos \beta_0}
  = - \frac{1}{4 h^2 \tan \beta_0} \log \left( 1 + \frac{R^2 \sin^2 \beta_0}{R^2 \cos^2 \beta_0 + h^2} \right) \tag{14}
  \end{align*}

  <p>結局4項目の積分結果は次のようになった．</p>

  \begin{align*}
  &\int^0_{R \cos \beta_0} \int_0^{x \tan \beta_0} \frac{2h^2 \cos \omega}{\pi (x^2 + y^2 + h^2)^2} dy dx \\
  &= -\frac{\cos \omega}{\pi \tan \beta_0} \left[ \frac{R \sin \beta_0}{\sqrt{R^2 \cos^2 \alpha_0 + h^2}} \arctan \left( \frac{R \sin \beta_0}{\sqrt{R^2 \cos^2 \beta_0 + h^2}} \right)
  \log \left\{ \cos \left( \arctan \left( \frac{R \sin \beta_0}{\sqrt{R^2 \cos^2 \beta_0 + h^2}} \right) \right) \right\} \right]
  - \frac{\cos \omega}{2 \pi \tan \beta_0} \log \left( 1 + \frac{R^2 \sin^2 \beta_0}{R^2 \cos^2 \beta_0 + h^2} \right) \tag{15}
  \end{align*}

  <p>
    この例では，対象が円板といういい形をしているので，なんとか計算できたものの，2重積分しなければいけないというのは非常に厄介だ．
    対象がもうちょっと変な形をしていたら，解析的な積分はほとんど不可能（Mathematicaとかに放り込めば，何かしらの答えは返してくれるかもしれないが）というのを感じてもらえたんじゃないだろうか．
  </p>

  <h2>Contour IntegrationによるView Factorの計算</h2>
  <p>
    面積分はストークスの定理を用ると，対象の面を取り囲むような線積分（Contour Integration）の形に置き換え，
    簡単に出来ることがあるが，View Factorの計算にはこの手法を適用できる．
    まずストークスの定理を確認しておこう
  </p>

  \begin{equation}
  \iint_{\Omega} \nabla \times \boldsymbol{F} \cdot d\boldsymbol{s} = \int_{\partial \Omega} \boldsymbol{F} \cdot d \boldsymbol{l} \tag{15}
  \end{equation}

  <p>各パラメタを明示的に書くと次のようになる．</p>

  \begin{equation}
  \iint_{\Omega} \left[ l \left( \frac{\partial R}{\partial y} - \frac{\partial Q}{\partial z} \right)
  + m \left( \frac{\partial P}{\partial z} - \frac{\partial R}{\partial x} \right)
  + n \left( \frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y} \right) \right] ds
  = \int_{\partial \Omega} \left( P \frac{dx}{dt} + Q \frac{dy}{dt} + R \frac{dz}{dt} \right) dt \tag{16}
  \end{equation}

  <p>さて，今求めたいView Factorは次のように表される．</p>

  \begin{align}
  F &= \int_A \frac{\cos \psi \cos \lambda}{\pi S^2} dA
  = \int \frac{(\boldsymbol{x} \cdot \boldsymbol{n}_1) \times (-\boldsymbol{x} \cdot \boldsymbol{n}_2)}{\pi S^4} dA \\
  &= \int (-l_2 x f - m_2 y f - n_2 z f)\ dA, \hspace{20pt}
  \mathrm{where}\ f = \frac{1}{\pi S^4} (l_1 x + m_1 y + n_1 z) \tag{17}
  \end{align}

  <p>これらの式を見比べると，ストークスの定理を用いるには，\(P,Q,R\)が次の関係を満たせばよいことが分かる．</p>

  \begin{align}
  \frac{\partial R}{\partial y} - \frac{\partial Q}{\partial z} = - x f,
  \hspace{10pt} \frac{\partial P}{\partial z} - \frac{\partial R}{\partial x} = - y f,
  \hspace{10pt} \frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y} = - z f \tag{18}
  \end{align}

  <p>天下り的だが，このように\(P,Q,R\)をとるとうまいこと条件が満たされる．</p>

  \begin{align}
  P = \frac{-m_1 z + n_1 y}{2 \pi S^2}, \hspace{10pt}
  Q = \frac{-n_1 x + l_1 z}{2 \pi S^2}, \hspace{10pt}
  R = \frac{-l_1 y + m_1 x}{2 \pi S^2} \tag{19}
  \end{align}

  <p>本当に満たされているか，ひとつ確認してみよう．</p>

  \begin{align}
  \frac{\partial R}{\partial y} &= \frac{\partial}{\partial y} \left(\frac{-l_1 y + m_1 x}{2 \pi S^2} \right) = \frac{-l}{2 \pi S^2} - \frac{(-l_1y + m_1x)y}{\pi S^4} \tag{20}\\
  \frac{\partial Q}{\partial z} &= \frac{\partial}{\partial z} \left(\frac{-n_1 x + l_1 z}{2 \pi S^2} \right) = \frac{l}{2 \pi S^2} - \frac{(-n_1x + l_1z)z}{\pi S^4} \tag{21}
  \end{align}

  \begin{align}
  \frac{\partial R}{\partial y} - \frac{\partial Q}{\partial z}
  &= \frac{-l_1(x^2 + y^2 + z^2)}{\pi S^4} + \frac{l_1y^2 - m_1xy - n_1xz + l_1z^2}{\pi S^4} \\
  &= \frac{-x (l_1 x + m_1 y + n_1 z)}{\pi S^4} = -xf \tag{22}
  \end{align}

  <p>適切な\(P,Q,R\)が見つかったので，View Factorを線積分で表すことができる．</p>

  \begin{align*}
  F &= \frac{1}{2 \pi} \int \left( \frac{-m_1 z + n_1 y}{S^2} dx + \frac{-n_1 x + l_1 z}{S^2} dy + \frac{-l_1 y + m_1 x}{S^2} dz \right) \\
  &= l_1 \int \frac{z dy - y dz}{2 \pi S^2} + m_1 \int \frac{x dz - z dx}{2 \pi S^2} + n_1 \int \frac{y dx - x dy}{2 \pi S^2} \tag{23}
  \end{align*}

  \begin{align*}
  &\left( \begin{array}{c}l_1 \\ m_1 \\ n_1\end{array} \right) 
  =\left( \begin{array}{c}\sin \omega \\ 0 \\ \cos \omega\end{array} \right)
  \mathrm{,~Infinitesimal~surface~direction} \tag{23} \\
  &\left( \begin{array}{c}x \\ y \\ z\end{array} \right) 
  =\left( \begin{array}{c}R \cos \alpha \\ R \sin \alpha \\ h\end{array} \right)
  \mathrm{,~Line~on~the~disk~edge} \tag{24} \\
  &\left( \begin{array}{c}x \\ y \\ z\end{array} \right) 
  =\left( \begin{array}{c}R \cos \alpha_0 \\ y \\ h\end{array} \right)
  \mathrm{,~Line~of~the~view~edge} \tag{25}
  \end{align*}

  <img src="..\images\disk_line.svg" width="300">
  <p>
    これで，View Factorを実際に計算する準備が整った．
    ひとつ注意点として，円板の向きを表すベクトル\((l_2, m_2, n_2)\)は下向きで，このベクトルに関して右回りになるように積分する．
  </p>

  \begin{align*}
  &F = l_1 \int \frac{z dy - y dz}{2 \pi S^2} + n_1 \int \frac{y dx - x dy}{2 \pi S^2} \\
  &= \sin \omega \left( \int_{\alpha_0}^{-\alpha_0} \frac{h (R \cos \alpha)}{2 \pi (R^2 + h^2)} d\alpha
  + \int_{-R \sin \alpha_0}^{R \sin \alpha_0} \frac{h}{2 \pi (R^2 \cos^2 \alpha_0 + y^2 + h^2)} dy \right)
  + \cos \omega \left( \int_{\alpha_0}^{-\alpha_0} \frac{R \sin \alpha (-R \sin \alpha) - R \cos \alpha (R \cos \alpha)}{2 \pi (R^2 + h^2)} d\alpha
  + \int_{-R \sin \alpha_0}^{R \sin \alpha_0} \frac{- R \cos \alpha_0}{2 \pi (R^2 \cos^2 \alpha_0 + y^2 + h^2)} dy \right) \\
  &= \frac{Rh \sin \omega}{2 \pi (R^2 + h^2)} \int^{-\alpha_0}_{\alpha_0} \cos \alpha d\alpha
  + \frac{h \sin \omega}{2 \pi} \int_{\arctan(-\frac{R \sin \alpha_0}{\sqrt{R^2 \cos^2 \alpha_0 + h^2}})}^{\arctan(\frac{R \sin \alpha_0}{\sqrt{R^2 \cos^2 \alpha_0 + h^2}})} \frac{dt}{\sqrt{R^2 \cos^2 \alpha_0 + h^2}}
  - \frac{R^2}{2 \pi (R^2 + h^2)} \int_{\alpha_0}^{-\alpha_0} d\alpha
  - \frac{R \cos \omega \cos \alpha_0}{2 \pi} \int_{\arctan(-\frac{R \sin \alpha_0}{\sqrt{R^2 \cos^2 \alpha_0 + h^2}})}^{\arctan(\frac{R \sin \alpha_0}{\sqrt{R^2 \cos^2 \alpha_0 + h^2}})} \frac{dt}{\sqrt{R^2 \cos^2 \alpha_0 + h^2}} \\
  &= - \frac{Rh \sin \omega \sin \alpha_0}{\pi (R^2 + h^2)} + \frac{h \sin \omega}{\pi \sqrt{R^2 \cos^2 \alpha_0 + h^2}} \arctan \left( \frac{R \sin \alpha_0}{\sqrt{R^2 \cos^2 \alpha_0 + h^2}} \right)
  + \frac{R^2 \alpha_0}{\pi (R^2 + h^2)} - \frac{R \cos \omega \cos \alpha_0}{\pi \sqrt{R^2 \cos^2 \alpha_0 + h^2}} \arctan \left( \frac{R \sin \alpha_0}{\sqrt{R^2 \cos^2 \alpha_0 + h^2}} \right) \tag{26}
  \end{align*}

  <p>非常に煩雑だった面積分の計算が，線積分に置き換えることでかなり簡略化されたのが分かる</p>

</body>

<footer>
  <a href="index.html">View Factor Calculator</a> &#187; <a href="vf-definition.html">What is a view factor?</a>
  <span style="float: right">Copyright 2022, Kaname Sasaki</span>
</footer>
</html>